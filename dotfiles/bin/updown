#!/bin/env python3
#
# Changes text into tHiS wEiRd FoRmAt
from subprocess import Popen, PIPE

def get_clipboard(primary: bool) -> str:
    flag = 'p' if primary else 'b'
    p = Popen(['xsel', f'-o{flag}'], stdout=PIPE, stderr=PIPE)
    out, err = p.communicate()
    if len(err) > 0:
        print(f"Failed to get clipboard: {err}")
    return out.decode('utf-8')

def set_clipboard(primary: bool, data: str):
    flag = 'p' if primary else 'b'
    p = Popen(['xsel', f'-i{flag}'], stdin=PIPE, stdout=PIPE, stderr=PIPE)
    out, err = p.communicate(data.encode('utf-8'))
    if len(err) > 0:
        print(f"Failed to set clipboard: {err}")


# ʇɐɯɹoɟ uʍop ǝpᴉsdn oʇuᴉ ʇxǝʇ sǝƃuɐɥƆ
from_az_low = 'abcdefghijklmnopqrstuvwxyz'
to_az_low = 'zʎxʍʌnʇsɹbdouɯlʞɾᴉɥƃɟǝpɔqɐ'
from_az_high = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
to_az_high = 'Z⅄XMΛ∩┴SɹQԀONW˥ʞſIHפℲƎpƆq∀'
from_sym = '!?.,-_/:;()[]{}\'"'
to_sym = ',,{}[]();:/‾-\'˙¿¡'
from_text = from_az_low + from_az_high + from_sym
to_text = to_az_low[::-1] + to_az_high[::-1] + to_sym[::-1]
def make_upside_down(text: str) -> str:
    out = ''
    for char in text:
        if char in from_text:
            out = to_text[from_text.index(char)] + out
        else:
            out = char + out
    return out

primary = True
set_clipboard(primary, make_upside_down(get_clipboard(primary)))
